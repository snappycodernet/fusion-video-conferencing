
services:
  livekit-client:
    build: ../
    ports:
      - "5173:5173"
    restart: unless-stopped

  livekit-dev:
    image: livekit/livekit-server:latest
    command: >
      --dev
      --bind 0.0.0.0
    environment:
      LIVEKIT_ALLOWED_ORIGINS: "http://localhost:5173,https://livekit-pndlm-client.ngrok.dev"
    ports:
      - "7880:7880"
      - "7881:7881"
    restart: unless-stopped

  livekit-auth:
    build: ./
    command: ["./livekit-auth-server"]
    environment:
      LIVEKIT_API_KEY: ${LIVEKIT_API_KEY}
      LIVEKIT_API_SECRET: ${LIVEKIT_API_SECRET}
    ports:
      - "8080:8080"
    restart: unless-stopped

  ngrok:
    image: ngrok/ngrok:latest
    command: start --all --config /etc/ngrok.yml
    volumes:
      - ./ngrok.yml:/etc/ngrok.yml:ro
    environment:
      NGROK_AUTHTOKEN: ${NGROK_AUTHTOKEN}
    depends_on:
      - livekit-auth
      - livekit-dev
      - livekit-client

